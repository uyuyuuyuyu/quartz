# Graph Theory Lecture Notes

## Topic 1: Correctness of Kruskal’s Algorithm

**Theorem 4.11:** Kruskal’s Algorithm produces a Minimum Spanning Tree (MST).

### Proof (by Contradiction and Exchange Argument)

**1. Setup:**
*   Let $T$ be the result of running Kruskal's Algorithm (KA) on a graph $G$.
*   We already know $T$ is a spanning tree.
*   **Assumption (BWOC):** Suppose $T$ is **not** an MST.
*   Let $H$ be an actual MST such that the intersection $|E(H) \cap E(T)|$ is maximized (i.e., $H$ is the MST that shares the most edges with $T$).

**2. The Exchange Step:**
*   Since $H \neq T$ and $|E(H)| = |E(T)|$, there exists an edge $e_t \in E(T) \setminus E(H)$.
*   Choose $e_t$ to have the minimum index (earliest added by KA) over $E(T) \setminus E(H)$.
*   Consider the graph $H + e_t$:
    *   Since $H$ is a tree, adding $e_t$ creates a unique cycle $C$.
    *   Since $T$ has no cycles, there is some edge $e_h$ in $C$ but not in $T$.
    *   Since $e_h$ is in a cycle in $H + e_t$, it is not a bridge, so removing it keeps the graph connected.
*   Define $H' = H + e_t - e_h$.
    *   $H'$ is connected and has the correct size ($|E(H')| = |E(H)|$), so $H'$ is a spanning tree.

**3. The Contradiction:**
*   **Case A (Weight comparison via Optimality of $H$):**
    *   The intersection $|E(H') \cap E(T)| > |E(H) \cap E(T)|$ (we removed $e_h \notin T$ and added $e_t \in T$).
    *   By our choice of $H$ (maximally similar to $T$), $H'$ cannot be a minimum spanning tree.
    *   Therefore, $w(H') > w(H)$, which implies **$w(e_t) > w(e_h)$**.

*   **Case B (Weight comparison via Kruskal's Algorithm):**
    *   Consider the state of the algorithm at step $t$ (when $e_t$ was added).
    *   The edges added so far are $\{e_1, \dots, e_{t-1}\} \subseteq E(H)$ (by the minimal index choice of $e_t$).
    *   The edge $e_h$ was available. The set $\{e_1, \dots, e_{t-1}, e_h\} \subseteq E(H)$. Since $H$ is acyclic, adding $e_h$ would not have created a cycle.
    *   Since Kruskal's greedy choice picked $e_t$ instead of $e_h$, it must be that **$w(e_t) \le w(e_h)$**.

*   **Conclusion:**
    *   We have $w(e_t) > w(e_h)$ and $w(e_t) \le w(e_h)$, which is a contradiction.
    *   Thus, $w(e_t)$ must equal $w(e_h)$, meaning $w(H') = w(H)$.
    *   If weights are equal, $H'$ is an MST with a larger intersection with $T$ than $H$, contradicting the choice of $H$.
    *   Therefore, $T$ must be an MST.

---

## Topic 2: The Number of Spanning Trees (Section 4.4)

**Theorem 4.15 (Cayley Tree Formula):**
The number of distinct spanning trees of order $n$ on a labelled vertex set is $n^{n-2}$.

### Definitions

**Digraph (Directed Graph) $D$:**
*   Consists of a finite nonempty vertex set $V$ and a set $E$ of ordered pairs of distinct vertices (called arcs or directed edges).
*   Notation: If $(u,v) \in E$, we indicate this with an arrow from $u$ to $v$ ($u \to v$).

**Directed Rooted Tree (DRT):**
A digraph is a DRT if it has the following properties:
1.  Its underlying graph (ignoring direction) is a tree.
2.  Every pair of vertices appears in at most one arc.
3.  There is one vertex $v_1$, called the **root**, with the following property: for every vertex $u$, the unique $v_1-u$ path in the underlying graph is a directed path (from $v_1$ to $u$) in the digraph.
    *   *Observation:* Root has in-degree 0; all other vertices have in-degree 1.

### Proof of Cayley Tree Formula

**Strategy:**
We will count the size of a set $|\mathcal{T}|$ in two different ways to solve for the unknown variable.

**Variables:**
*   Let $T_n$ be the number of distinct spanning trees on $K_n$ (the complete graph with $n$ vertices). This is the value we want to find.
*   Let $\mathcal{T}$ be the set of sequences consisting of one vertex and $(n-1)$ directed edges, whose elements form a DRT of $K_n$.

**First Count (Building the structure step-by-step):**
We construct an element of $\mathcal{T}$ via the following steps:

1.  **Choose an underlying graph:**
    *   There are **$T_n$** ways to choose the underlying spanning tree.
2.  **Choose a root:**
    *   There are **$n$** ways to choose the root vertex.
    *   *Note:* Once the tree and root are picked, the direction of every edge is fixed (must point away from root).
3.  **Permute the edges:**
    *   The set $\mathcal{T}$ is defined as a sequence, so order matters.
    *   There are **$(n-1)!$** ways to order the edges.

**Result of First Count:**
$$ |\mathcal{T}| = T_n \cdot n \cdot (n-1)! = T_n \cdot n! $$